## **题目 01- 请你说一说什么是线程和进程？**

- 区别
- 关系
- 线程的上下文切换是什么？
- 线程的并发与并行有啥区别？

## **题目 02- 使用了多线程会带来什么问题呢？**

- 能不能详细说说线程安全问题？
- 原子性、有序性和可见性能不能深入的谈一下。

## **题目 03- 什么是死锁？如何排查死锁?** 排查过程最好详细说明，最少说一种排查方案，越多越好。



## 答：

### **题目 01：**

**进程**：英文对应 process，是指内存中正在运行的一个应用程序，每个进程都有自己独立的内存空间。程序本身只是指令、数据机器组织形式的描述，相当于一个名词，进程才是程序（哪些指令和数据）的真正执行实例，相当于现在进行时。进程是系统运行程序的基本单位，系统运行一个程序即是对应进程从创建、运行到消亡的过程。

**线程**：英文对应 thread，是进程中的一个执行单元，是比进程更加轻量级的调度执行单位。

​    

**进程与线程的区别**：

- **进程**：有独立的内存空间，每个进程中的数据空间都是独立的，彼此不能相互访问。
- **线程**：目前线程是 Java 里面进行处理器资源调度的最近本单位。在同一个 JVM 实例中，多线程之间堆空间与方法区是共享的，但每一个线程的栈空间、程序计数器是独立的，线程消耗的资源比进程小的多。

​    

**进程与线程的关系**：

线程是由进程产生的，同一个进程中的线程可以共享进程资源（内存地址、文件 I/O 等）。

​    

**线程的上下文切换：**

产生线程上下文切换的背景：

现在计算机一般都是多核 CPU，且操作系统都能够同时支持远大于 CPU 内核数的线程运行。而一个 CPU 内核，同一时刻只能被一个线程使用。为了提升 CPU 的利用率，CPU 采用了时间片算法将 CPU 时间片轮流分配给多个线程，每个线程分配了一个时间片（几十毫秒/线程），线程在时间片内，使用 CPU执行任务。当时间片用完后，线程会被挂起，然后把 CPU 让给其他线程使用。

线程上下文其实就是当时间片用完时，当前线程的运行状态。线程被挂起时，这个线程状态会被保存起来，用于下次切换回来使用 CPU 时再次加载。

​    

**线程并发与并行的区别：**

**并发**：Concurrent，同一时间段，多个任务都在执行，单位时间内不一定同时执行。

**并行**：Parallel，单位时间内，多个任务同时执行，单位时间内一定是同时执行。并行上限取决于 CPU 的核数。

**区别：**线程的并发和并行都可以是很多个线程，就看这些线程能不能同时被（多个）CPU 执行，如果可以就说明是并行，而并发是多个线程被（一个）CPU 轮流切换着执行。

​     

**题目02：**

**线程安全问题** 

在 Java 语言中，当多个线程访问某个类时，不管运行时环境采用何种调度方式或者这些线程将如何交替执行，并且在主调代码中不需要任何额外的同步或协同，这个类都能表现出正确的行为，那么就称这个类时线程安全的。    

如果在我们的程序中，使用了多线程，且多个线程之间存在共享数据（比如：全局变量及静态变量的共享），那就可能出现共享数据的变化不可控的情况。    

为了保证不出现线程安全问题， 即当多个线程访问某个状态变量并且其中有一个线程执行写入操作时，必须采用同步机制来协同这些线程对变量的访问。Java 中的主要同步机制是关键字 synchronized，它提供一种独占的加锁方式，但“同步”这个属于还包括 volatile类型的变量，显式锁以及原子变量。

​    

**原子性、有序性和可见性** 

在多线程并发编程中，我们主要是围绕这三个特性进行问题处理，这三个特性就是：原子性、有序性和可见性。    

**原子性：**即一个操作或多个操作，要么全部执行，要么就都不执行。执行过程中，不能被打断。    

**有序性：**程序代码按照先后顺序执行。影响有序性的一个因素就是指令重排。    

**可见性：**当多个线程访问同一个变量时，一个线程修改这个变量的值，其他线程能够立即看得到修改后的值。    